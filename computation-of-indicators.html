<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Computation of indicators | Spatial data analysis</title>
  <meta name="description" content="Chapter 3 Computation of indicators | Spatial data analysis" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Computation of indicators | Spatial data analysis" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Computation of indicators | Spatial data analysis" />
  
  
  

<meta name="author" content="Saif Shabou" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-exploration.html"/>
<link rel="next" href="clustering.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="data-exploration.html"><a href="data-exploration.html"><i class="fa fa-check"></i><b>2</b> Data exploration</a><ul>
<li class="chapter" data-level="2.1" data-path="data-exploration.html"><a href="data-exploration.html#get-remote-sensing-data"><i class="fa fa-check"></i><b>2.1</b> Get remote sensing data</a></li>
<li class="chapter" data-level="2.2" data-path="data-exploration.html"><a href="data-exploration.html#data-visualization"><i class="fa fa-check"></i><b>2.2</b> Data visualization</a></li>
<li class="chapter" data-level="2.3" data-path="data-exploration.html"><a href="data-exploration.html#subset-and-rename-bands"><i class="fa fa-check"></i><b>2.3</b> Subset and rename bands</a><ul>
<li class="chapter" data-level="2.3.1" data-path="data-exploration.html"><a href="data-exploration.html#load-all-the-layers"><i class="fa fa-check"></i><b>2.3.1</b> load all the layers</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-exploration.html"><a href="data-exploration.html#spatial-subset"><i class="fa fa-check"></i><b>2.3.2</b> Spatial subset</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-exploration.html"><a href="data-exploration.html#spectral-profiles"><i class="fa fa-check"></i><b>2.4</b> Spectral profiles</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="computation-of-indicators.html"><a href="computation-of-indicators.html"><i class="fa fa-check"></i><b>3</b> Computation of indicators</a><ul>
<li class="chapter" data-level="3.1" data-path="computation-of-indicators.html"><a href="computation-of-indicators.html#ndvi-index"><i class="fa fa-check"></i><b>3.1</b> NDVI Index</a></li>
<li class="chapter" data-level="3.2" data-path="computation-of-indicators.html"><a href="computation-of-indicators.html#principal-component-analysis"><i class="fa fa-check"></i><b>3.2</b> Principal Component Analysis</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>4</b> Clustering</a></li>
<li class="chapter" data-level="5" data-path="supervised-classifcation.html"><a href="supervised-classifcation.html"><i class="fa fa-check"></i><b>5</b> Supervised Classifcation</a><ul>
<li class="chapter" data-level="5.1" data-path="supervised-classifcation.html"><a href="supervised-classifcation.html#reference-data"><i class="fa fa-check"></i><b>5.1</b> Reference data</a></li>
<li class="chapter" data-level="5.2" data-path="supervised-classifcation.html"><a href="supervised-classifcation.html#generate-sample-sites"><i class="fa fa-check"></i><b>5.2</b> Generate sample sites</a></li>
<li class="chapter" data-level="5.3" data-path="supervised-classifcation.html"><a href="supervised-classifcation.html#extract-values-for-sites"><i class="fa fa-check"></i><b>5.3</b> Extract values for sites</a></li>
<li class="chapter" data-level="5.4" data-path="supervised-classifcation.html"><a href="supervised-classifcation.html#train-the-classifier"><i class="fa fa-check"></i><b>5.4</b> Train the classifier</a></li>
<li class="chapter" data-level="5.5" data-path="supervised-classifcation.html"><a href="supervised-classifcation.html#classify"><i class="fa fa-check"></i><b>5.5</b> Classify</a></li>
<li class="chapter" data-level="5.6" data-path="supervised-classifcation.html"><a href="supervised-classifcation.html#model-evaluation"><i class="fa fa-check"></i><b>5.6</b> Model Evaluation</a><ul>
<li class="chapter" data-level="5.6.1" data-path="supervised-classifcation.html"><a href="supervised-classifcation.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>5.6.1</b> K-fold cross validation</a></li>
<li class="chapter" data-level="5.6.2" data-path="supervised-classifcation.html"><a href="supervised-classifcation.html#overall-accuracy"><i class="fa fa-check"></i><b>5.6.2</b> Overall accuracy</a></li>
<li class="chapter" data-level="5.6.3" data-path="supervised-classifcation.html"><a href="supervised-classifcation.html#kappa-statistic"><i class="fa fa-check"></i><b>5.6.3</b> Kappa statistic</a></li>
<li class="chapter" data-level="5.6.4" data-path="supervised-classifcation.html"><a href="supervised-classifcation.html#producer-and-user-accuracy"><i class="fa fa-check"></i><b>5.6.4</b> Producer and user accuracy</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial data analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="computation-of-indicators" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Computation of indicators</h1>
<div id="ndvi-index" class="section level2">
<h2><span class="header-section-number">3.1</span> NDVI Index</h2>
<p>We can perform some mathematical operations over grid cells. One of the most famous index used in Remote Sensing Image Analysis, is the Normalized Difference Vegetation Index</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="co"># let&#39;s define the function to compute ndvi index</span></a>
<a class="sourceLine" id="cb31-2" title="2">vi &lt;-<span class="st"> </span><span class="cf">function</span>(img, k, i) {</a>
<a class="sourceLine" id="cb31-3" title="3">  bk &lt;-<span class="st"> </span>img[[k]]</a>
<a class="sourceLine" id="cb31-4" title="4">  bi &lt;-<span class="st"> </span>img[[i]]</a>
<a class="sourceLine" id="cb31-5" title="5">  vi &lt;-<span class="st"> </span>(bk <span class="op">-</span><span class="st"> </span>bi) <span class="op">/</span><span class="st"> </span>(bk <span class="op">+</span><span class="st"> </span>bi)</a>
<a class="sourceLine" id="cb31-6" title="6">  <span class="kw">return</span>(vi)</a>
<a class="sourceLine" id="cb31-7" title="7">}</a>
<a class="sourceLine" id="cb31-8" title="8"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb31-9" title="9">ndvi &lt;-<span class="st"> </span><span class="kw">vi</span>(landsat, <span class="dv">5</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb31-10" title="10"><span class="kw">plot</span>(ndvi, <span class="dt">col =</span> <span class="kw">rev</span>(<span class="kw">terrain.colors</span>(<span class="dv">10</span>)), <span class="dt">main =</span> <span class="st">&quot;Landsat-NDVI&quot;</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="co"># view histogram of data</span></a>
<a class="sourceLine" id="cb32-2" title="2"><span class="kw">hist</span>(ndvi,</a>
<a class="sourceLine" id="cb32-3" title="3">     <span class="dt">main =</span> <span class="st">&quot;Distribution of NDVI values&quot;</span>,</a>
<a class="sourceLine" id="cb32-4" title="4">     <span class="dt">xlab =</span> <span class="st">&quot;NDVI&quot;</span>,</a>
<a class="sourceLine" id="cb32-5" title="5">     <span class="dt">ylab=</span> <span class="st">&quot;Frequency&quot;</span>,</a>
<a class="sourceLine" id="cb32-6" title="6">     <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>,</a>
<a class="sourceLine" id="cb32-7" title="7">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb32-8" title="8">     <span class="dt">breaks =</span> <span class="dv">30</span>,</a>
<a class="sourceLine" id="cb32-9" title="9">     <span class="dt">xaxt =</span> <span class="st">&#39;n&#39;</span>)</a>
<a class="sourceLine" id="cb32-10" title="10"><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="dt">at =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="dv">1</span>, <span class="fl">0.05</span>), <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="dv">1</span>, <span class="fl">0.05</span>))</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-13-2.png" width="672" />
In order to identify better the areas with vegetation, we can reclassify differently the values.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">vegc &lt;-<span class="st"> </span><span class="kw">reclassify</span>(ndvi, <span class="kw">c</span>(<span class="op">-</span><span class="ot">Inf</span>,<span class="fl">0.25</span>,<span class="dv">1</span>, <span class="fl">0.25</span>,<span class="fl">0.3</span>,<span class="dv">2</span>, <span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="dv">3</span>, <span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="dv">4</span>, <span class="fl">0.5</span>,<span class="ot">Inf</span>, <span class="dv">5</span>))</a>
<a class="sourceLine" id="cb33-2" title="2"><span class="kw">plot</span>(vegc,<span class="dt">col =</span> <span class="kw">rev</span>(<span class="kw">terrain.colors</span>(<span class="dv">4</span>)), <span class="dt">main =</span> <span class="st">&#39;NDVI based thresholding&#39;</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="principal-component-analysis" class="section level2">
<h2><span class="header-section-number">3.2</span> Principal Component Analysis</h2>
<p>Multi-spectral data are sometimes transformed to helps to reduce the dimensionality and noise in the data. The principal components transform is a generic data reduction method that can be used to create a few uncorrelated bands from a larger set of correlated bands.</p>
<p>You can calculate the same number of principal components as the number of input bands. The first principal component (PC) explains the largest percentage of variance and other PCs explain additional the variance in decreasing order.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="co"># Take a random sample from the cell values</span></a>
<a class="sourceLine" id="cb34-2" title="2"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb34-3" title="3">sr &lt;-<span class="st"> </span><span class="kw">sampleRandom</span>(landsat, <span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb34-4" title="4"><span class="co"># perform PCA to the resulting matrix</span></a>
<a class="sourceLine" id="cb34-5" title="5">pca &lt;-<span class="st"> </span><span class="kw">prcomp</span>(sr, <span class="dt">scale =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb34-6" title="6"><span class="kw">screeplot</span>(pca)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>The first principal component highlights the boundaries between land use classes or spatial details, which is the most common information among all wavelengths.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">pci &lt;-<span class="st"> </span><span class="kw">predict</span>(landsat, pca, <span class="dt">index =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb35-2" title="2"></a>
<a class="sourceLine" id="cb35-3" title="3">pc2 &lt;-<span class="st"> </span><span class="kw">reclassify</span>(pci[[<span class="dv">2</span>]], <span class="kw">c</span>(<span class="op">-</span><span class="ot">Inf</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="ot">Inf</span>,<span class="ot">NA</span>))</a>
<a class="sourceLine" id="cb35-4" title="4"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb35-5" title="5"><span class="kw">plotRGB</span>(landsatFCC, <span class="dt">r =</span> <span class="dv">1</span>, <span class="dt">g =</span> <span class="dv">2</span>, <span class="dt">b =</span> <span class="dv">3</span>, <span class="dt">axes =</span> <span class="ot">TRUE</span>, <span class="dt">stretch =</span> <span class="st">&quot;lin&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Landsat False Color Composite&quot;</span>)</a>
<a class="sourceLine" id="cb35-6" title="6"><span class="kw">plotRGB</span>(landsatFCC, <span class="dt">r =</span> <span class="dv">1</span>, <span class="dt">g =</span> <span class="dv">2</span>, <span class="dt">b =</span> <span class="dv">3</span>, <span class="dt">axes =</span> <span class="ot">TRUE</span>, <span class="dt">stretch =</span> <span class="st">&quot;lin&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Landsat False Color Composite&quot;</span>)</a>
<a class="sourceLine" id="cb35-7" title="7"><span class="kw">plot</span>(pc2, <span class="dt">legend =</span> <span class="ot">FALSE</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-exploration.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="clustering.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
