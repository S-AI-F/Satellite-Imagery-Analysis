<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Data exploration | Spatial data analysis</title>
  <meta name="description" content="Chapter 2 Data exploration | Spatial data analysis" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Data exploration | Spatial data analysis" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Data exploration | Spatial data analysis" />
  
  
  

<meta name="author" content="Saif Shabou" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="computation-of-indicators.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="data-exploration.html"><a href="data-exploration.html"><i class="fa fa-check"></i><b>2</b> Data exploration</a><ul>
<li class="chapter" data-level="2.1" data-path="data-exploration.html"><a href="data-exploration.html#get-remote-sensing-data"><i class="fa fa-check"></i><b>2.1</b> Get remote sensing data</a></li>
<li class="chapter" data-level="2.2" data-path="data-exploration.html"><a href="data-exploration.html#data-visualization"><i class="fa fa-check"></i><b>2.2</b> Data visualization</a></li>
<li class="chapter" data-level="2.3" data-path="data-exploration.html"><a href="data-exploration.html#subset-and-rename-bands"><i class="fa fa-check"></i><b>2.3</b> Subset and rename bands</a><ul>
<li class="chapter" data-level="2.3.1" data-path="data-exploration.html"><a href="data-exploration.html#load-all-the-layers"><i class="fa fa-check"></i><b>2.3.1</b> load all the layers</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-exploration.html"><a href="data-exploration.html#spatial-subset"><i class="fa fa-check"></i><b>2.3.2</b> Spatial subset</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-exploration.html"><a href="data-exploration.html#spectral-profiles"><i class="fa fa-check"></i><b>2.4</b> Spectral profiles</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="computation-of-indicators.html"><a href="computation-of-indicators.html"><i class="fa fa-check"></i><b>3</b> Computation of indicators</a><ul>
<li class="chapter" data-level="3.1" data-path="computation-of-indicators.html"><a href="computation-of-indicators.html#ndvi-index"><i class="fa fa-check"></i><b>3.1</b> NDVI Index</a></li>
<li class="chapter" data-level="3.2" data-path="computation-of-indicators.html"><a href="computation-of-indicators.html#principal-component-analysis"><i class="fa fa-check"></i><b>3.2</b> Principal Component Analysis</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>4</b> Clustering</a></li>
<li class="chapter" data-level="5" data-path="supervised-classifcation.html"><a href="supervised-classifcation.html"><i class="fa fa-check"></i><b>5</b> Supervised Classifcation</a><ul>
<li class="chapter" data-level="5.1" data-path="supervised-classifcation.html"><a href="supervised-classifcation.html#reference-data"><i class="fa fa-check"></i><b>5.1</b> Reference data</a></li>
<li class="chapter" data-level="5.2" data-path="supervised-classifcation.html"><a href="supervised-classifcation.html#generate-sample-sites"><i class="fa fa-check"></i><b>5.2</b> Generate sample sites</a></li>
<li class="chapter" data-level="5.3" data-path="supervised-classifcation.html"><a href="supervised-classifcation.html#extract-values-for-sites"><i class="fa fa-check"></i><b>5.3</b> Extract values for sites</a></li>
<li class="chapter" data-level="5.4" data-path="supervised-classifcation.html"><a href="supervised-classifcation.html#train-the-classifier"><i class="fa fa-check"></i><b>5.4</b> Train the classifier</a></li>
<li class="chapter" data-level="5.5" data-path="supervised-classifcation.html"><a href="supervised-classifcation.html#classify"><i class="fa fa-check"></i><b>5.5</b> Classify</a></li>
<li class="chapter" data-level="5.6" data-path="supervised-classifcation.html"><a href="supervised-classifcation.html#model-evaluation"><i class="fa fa-check"></i><b>5.6</b> Model Evaluation</a><ul>
<li class="chapter" data-level="5.6.1" data-path="supervised-classifcation.html"><a href="supervised-classifcation.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>5.6.1</b> K-fold cross validation</a></li>
<li class="chapter" data-level="5.6.2" data-path="supervised-classifcation.html"><a href="supervised-classifcation.html#overall-accuracy"><i class="fa fa-check"></i><b>5.6.2</b> Overall accuracy</a></li>
<li class="chapter" data-level="5.6.3" data-path="supervised-classifcation.html"><a href="supervised-classifcation.html#kappa-statistic"><i class="fa fa-check"></i><b>5.6.3</b> Kappa statistic</a></li>
<li class="chapter" data-level="5.6.4" data-path="supervised-classifcation.html"><a href="supervised-classifcation.html#producer-and-user-accuracy"><i class="fa fa-check"></i><b>5.6.4</b> Producer and user accuracy</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial data analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-exploration" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Data exploration</h1>
<div id="get-remote-sensing-data" class="section level2">
<h2><span class="header-section-number">2.1</span> Get remote sensing data</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># dir.create(&#39;data&#39;, showWarnings = FALSE)</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co"># </span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co"># if (!file.exists(&#39;data/rs/samples.rds&#39;)) {</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">#   download.file(&#39;https://biogeo.ucdavis.edu/data/rspatial/rsdata.zip&#39;, dest = &#39;data/rsdata.zip&#39;)</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">#   unzip(&#39;data/rsdata.zip&#39;, exdir=&#39;data&#39;)</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co"># }</span></a></code></pre></div>
</div>
<div id="data-visualization" class="section level2">
<h2><span class="header-section-number">2.2</span> Data visualization</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">library</span>(raster)</a></code></pre></div>
<pre><code>## Loading required package: sp</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">library</span>(rgdal)</a></code></pre></div>
<pre><code>## rgdal: version: 1.4-8, (SVN revision 845)
##  Geospatial Data Abstraction Library extensions to R successfully loaded
##  Loaded GDAL runtime: GDAL 2.2.3, released 2017/11/20
##  Path to GDAL shared files: C:/Users/saif/Documents/R/win-library/3.6/rgdal/gdal
##  GDAL binary built with GEOS: TRUE 
##  Loaded PROJ.4 runtime: Rel. 4.9.3, 15 August 2016, [PJ_VERSION: 493]
##  Path to PROJ.4 shared files: C:/Users/saif/Documents/R/win-library/3.6/rgdal/proj
##  Linking to sp version: 1.4-1</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># Blue</span></a>
<a class="sourceLine" id="cb6-2" title="2">b2 &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="st">&#39;data/rs/LC08_044034_20170614_B2.tif&#39;</span>)</a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co"># Green</span></a>
<a class="sourceLine" id="cb6-4" title="4">b3 &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="st">&#39;data/rs/LC08_044034_20170614_B3.tif&#39;</span>)</a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co"># Red</span></a>
<a class="sourceLine" id="cb6-6" title="6">b4 &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="st">&#39;data/rs/LC08_044034_20170614_B4.tif&#39;</span>)</a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co"># Near Infrared (NIR)</span></a>
<a class="sourceLine" id="cb6-8" title="8">b5 &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="st">&#39;data/rs/LC08_044034_20170614_B5.tif&#39;</span>)</a>
<a class="sourceLine" id="cb6-9" title="9"></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co"># Single band and composite maps</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co"># You can plot individual layers of a RasterStack of a multi-spectral image.</span></a>
<a class="sourceLine" id="cb6-12" title="12"></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb6-14" title="14"><span class="kw">plot</span>(b2, <span class="dt">main =</span> <span class="st">&quot;Blue&quot;</span>, <span class="dt">col =</span> <span class="kw">gray</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="dv">100</span>))</a>
<a class="sourceLine" id="cb6-15" title="15"><span class="kw">plot</span>(b3, <span class="dt">main =</span> <span class="st">&quot;Green&quot;</span>, <span class="dt">col =</span> <span class="kw">gray</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="dv">100</span>))</a>
<a class="sourceLine" id="cb6-16" title="16"><span class="kw">plot</span>(b4, <span class="dt">main =</span> <span class="st">&quot;Red&quot;</span>, <span class="dt">col =</span> <span class="kw">gray</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="dv">100</span>))</a>
<a class="sourceLine" id="cb6-17" title="17"><span class="kw">plot</span>(b5, <span class="dt">main =</span> <span class="st">&quot;NIR&quot;</span>, <span class="dt">col =</span> <span class="kw">gray</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="dv">100</span>))</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>To make a true (natural) color image that looks like a normal photograph (vegetation in green, water in blue…).
The true-color reveals much about landscape than gray images.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">landsatRGB &lt;-<span class="st"> </span><span class="kw">stack</span>(b4, b3, b2)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">plotRGB</span>(landsatRGB, <span class="dt">axes =</span> <span class="ot">TRUE</span>, <span class="dt">stretch =</span> <span class="st">&quot;lin&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Landsat True Color Composite&quot;</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Anoher popular image visualization method in remote sensing is known as “False color” image.
This representation makes it easy to see the vegetaion (in red).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">plotRGB</span>(landsatRGB, <span class="dt">axes =</span> <span class="ot">TRUE</span>, <span class="dt">stretch =</span> <span class="st">&quot;lin&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Landsat True Color Composite&quot;</span>)</a>
<a class="sourceLine" id="cb8-3" title="3">landsatFCC =<span class="st"> </span><span class="kw">stack</span>(b5,b4,b3)</a>
<a class="sourceLine" id="cb8-4" title="4"><span class="kw">plotRGB</span>(landsatFCC, <span class="dt">axes =</span> <span class="ot">TRUE</span>, <span class="dt">stretch =</span> <span class="st">&quot;lin&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Landsat False Color Composite&quot;</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="subset-and-rename-bands" class="section level2">
<h2><span class="header-section-number">2.3</span> Subset and rename bands</h2>
<div id="load-all-the-layers" class="section level3">
<h3><span class="header-section-number">2.3.1</span> load all the layers</h3>
<p>We can create a RasterStack withh the 11 layers. These layers represent reflection intensity in the following wavelengths: Ultra Blue, Blue, Green, Red, Near Infrared (NIR), Shortwave Infrared (SWIR) 1, Shortwave Infrared (SWIR) 2, Panachromatic, Cirrus, Thermal Infrared (TIRS) 1, Thermal Infrared (TIRS) 2.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">filenames &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;data/rs/LC08_044034_20170614_B&#39;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">11</span>, <span class="st">&quot;.tif&quot;</span>)</a>
<a class="sourceLine" id="cb9-2" title="2">filenames</a></code></pre></div>
<pre><code>##  [1] &quot;data/rs/LC08_044034_20170614_B1.tif&quot; 
##  [2] &quot;data/rs/LC08_044034_20170614_B2.tif&quot; 
##  [3] &quot;data/rs/LC08_044034_20170614_B3.tif&quot; 
##  [4] &quot;data/rs/LC08_044034_20170614_B4.tif&quot; 
##  [5] &quot;data/rs/LC08_044034_20170614_B5.tif&quot; 
##  [6] &quot;data/rs/LC08_044034_20170614_B6.tif&quot; 
##  [7] &quot;data/rs/LC08_044034_20170614_B7.tif&quot; 
##  [8] &quot;data/rs/LC08_044034_20170614_B8.tif&quot; 
##  [9] &quot;data/rs/LC08_044034_20170614_B9.tif&quot; 
## [10] &quot;data/rs/LC08_044034_20170614_B10.tif&quot;
## [11] &quot;data/rs/LC08_044034_20170614_B11.tif&quot;</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">landsat &lt;-<span class="st"> </span><span class="kw">stack</span>(filenames)</a>
<a class="sourceLine" id="cb11-2" title="2">landsat</a></code></pre></div>
<pre><code>## class      : RasterStack 
## dimensions : 1245, 1497, 1863765, 11  (nrow, ncol, ncell, nlayers)
## resolution : 30, 30  (x, y)
## extent     : 594090, 639000, 4190190, 4227540  (xmin, xmax, ymin, ymax)
## crs        : +proj=utm +zone=10 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0 
## names      : LC08_044034_20170614_B1, LC08_044034_20170614_B2, LC08_044034_20170614_B3, LC08_044034_20170614_B4, LC08_044034_20170614_B5, LC08_044034_20170614_B6, LC08_044034_20170614_B7, LC08_044034_20170614_B8, LC08_044034_20170614_B9, LC08_044034_20170614_B10, LC08_044034_20170614_B11 
## min values :            9.641791e-02,            7.483990e-02,            4.259216e-02,            2.084067e-02,            8.457669e-04,           -7.872183e-03,           -5.052945e-03,            3.931751e-02,           -4.337332e-04,             2.897978e+02,             2.885000e+02 
## max values :              0.73462820,              0.71775615,              0.69246972,              0.78617686,              1.01243150,              1.04320455,              1.11793602,              0.82673049,              0.03547901,             322.43139648,             317.99530029</code></pre>
<p>We can select specific layers (bands)</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co"># select first 7 bands only</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="kw">nlayers</span>(landsat)</a></code></pre></div>
<pre><code>## [1] 11</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">landsat &lt;-<span class="st"> </span><span class="kw">subset</span>(landsat, <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)</a>
<a class="sourceLine" id="cb15-2" title="2"><span class="kw">nlayers</span>(landsat)</a></code></pre></div>
<pre><code>## [1] 7</code></pre>
<p>For clarity, we can set the names of the bands</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">names</span>(landsat)</a></code></pre></div>
<pre><code>## [1] &quot;LC08_044034_20170614_B1&quot; &quot;LC08_044034_20170614_B2&quot;
## [3] &quot;LC08_044034_20170614_B3&quot; &quot;LC08_044034_20170614_B4&quot;
## [5] &quot;LC08_044034_20170614_B5&quot; &quot;LC08_044034_20170614_B6&quot;
## [7] &quot;LC08_044034_20170614_B7&quot;</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">names</span>(landsat) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;ultra-blue&#39;</span>, <span class="st">&#39;blue&#39;</span>, <span class="st">&#39;green&#39;</span>, <span class="st">&#39;red&#39;</span>, <span class="st">&#39;NIR&#39;</span>, <span class="st">&#39;SWIR1&#39;</span>, <span class="st">&#39;SWIR2&#39;</span>)</a>
<a class="sourceLine" id="cb19-2" title="2"><span class="kw">names</span>(landsat)</a></code></pre></div>
<pre><code>## [1] &quot;ultra.blue&quot; &quot;blue&quot;       &quot;green&quot;      &quot;red&quot;        &quot;NIR&quot;       
## [6] &quot;SWIR1&quot;      &quot;SWIR2&quot;</code></pre>
</div>
<div id="spatial-subset" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Spatial subset</h3>
<p>We can use spatial subsetting in order to limit the analysis to a geographical region. We can specify the extent coordinates similar to the example above and we can use interactive selection from the image with “drawExtent” and “drawPoly” functions.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co"># Using extent</span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="kw">extent</span>(landsat)</a></code></pre></div>
<pre><code>## class      : Extent 
## xmin       : 594090 
## xmax       : 639000 
## ymin       : 4190190 
## ymax       : 4227540</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">e &lt;-<span class="st"> </span><span class="kw">extent</span>(<span class="dv">610000</span>, <span class="dv">4200000</span>, <span class="dv">630000</span>,<span class="dv">4220000</span>)</a>
<a class="sourceLine" id="cb23-2" title="2"><span class="co"># crop landsat by the extent</span></a>
<a class="sourceLine" id="cb23-3" title="3">landsatcrop &lt;-<span class="st"> </span><span class="kw">crop</span>(landsat, e)</a>
<a class="sourceLine" id="cb23-4" title="4"></a>
<a class="sourceLine" id="cb23-5" title="5"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb23-6" title="6"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb23-7" title="7"><span class="kw">plot</span>(landsat[[<span class="dv">5</span>]])</a>
<a class="sourceLine" id="cb23-8" title="8"><span class="kw">rect</span>(e[<span class="dv">1</span>],e[<span class="dv">2</span>],e[<span class="dv">3</span>],e[<span class="dv">4</span>], <span class="dt">border=</span><span class="st">&#39;red&#39;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb23-9" title="9"><span class="kw">plot</span>(landsatcrop[[<span class="dv">5</span>]])</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>The subbset image can be saved with “writeRaster” function</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="co"># x &lt;- writeRaster(landsatcrop, filename=&quot;cropped-landsat.tif&quot;, overwrite=TRUE)</span></a></code></pre></div>
</div>
</div>
<div id="spectral-profiles" class="section level2">
<h2><span class="header-section-number">2.4</span> Spectral profiles</h2>
<p>The spectral profile is a plot of the spectrum for pixels representing a certain earth surface features. It demonstrates the difference in spectral properties of various earth surface features.</p>
<p>To do that, we need to join information about the lad use and land cover with pixel values of the raster data.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co"># load the polygons with land use land cover information</span></a>
<a class="sourceLine" id="cb25-2" title="2">samp &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&#39;data/rs/samples.rds&#39;</span>)</a>
<a class="sourceLine" id="cb25-3" title="3"><span class="co"># generate 300 point samples from the polygons</span></a>
<a class="sourceLine" id="cb25-4" title="4">ptsamp &lt;-<span class="st"> </span><span class="kw">spsample</span>(samp, <span class="dv">300</span>, <span class="dt">type=</span><span class="st">&#39;regular&#39;</span>)</a>
<a class="sourceLine" id="cb25-5" title="5"><span class="co"># add the land cover class to the points</span></a>
<a class="sourceLine" id="cb25-6" title="6">ptsamp<span class="op">$</span>class &lt;-<span class="st"> </span><span class="kw">over</span>(ptsamp, samp)<span class="op">$</span>class</a>
<a class="sourceLine" id="cb25-7" title="7"><span class="co"># extract values with points</span></a>
<a class="sourceLine" id="cb25-8" title="8">df &lt;-<span class="st"> </span><span class="kw">extract</span>(landsat, ptsamp)</a>
<a class="sourceLine" id="cb25-9" title="9"><span class="co"># To see some of the reflectance values</span></a>
<a class="sourceLine" id="cb25-10" title="10"><span class="kw">head</span>(df)</a></code></pre></div>
<pre><code>##      ultra.blue      blue      green        red       NIR     SWIR1     SWIR2
## [1,]  0.1348463 0.1171285 0.10090701 0.10077689 0.1620628 0.2171030 0.1806697
## [2,]  0.1325042 0.1150899 0.09971425 0.09843475 0.1831637 0.2129608 0.1747276
## [3,]  0.1334800 0.1288825 0.13744865 0.18316367 0.3254918 0.3292869 0.1989731
## [4,]  0.1443883 0.1468389 0.16507718 0.22690523 0.3690165 0.3911583 0.2422809
## [5,]  0.1321572 0.1143743 0.09774078 0.09529021 0.1667254 0.2016405 0.1645567
## [6,]  0.1372752 0.1200344 0.10405154 0.10411660 0.1676145 0.2153030 0.1779589</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="kw">plot</span>(landsat[[<span class="dv">5</span>]])</a>
<a class="sourceLine" id="cb27-3" title="3"><span class="kw">plot</span>(samp, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">border =</span> <span class="st">&#39;red&#39;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb27-4" title="4"><span class="kw">plot</span>(ptsamp, <span class="dt">pch =</span> <span class="dv">21</span>, <span class="dt">bg =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">cex =</span> <span class="fl">0.45</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Now, we can compute he mean reflectance values for each class and each band</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">ms &lt;-<span class="st"> </span><span class="kw">aggregate</span>(df, <span class="kw">list</span>(ptsamp<span class="op">$</span>class), mean)</a>
<a class="sourceLine" id="cb28-2" title="2"><span class="co"># instead of the first column, we use row names</span></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="kw">rownames</span>(ms) &lt;-<span class="st"> </span>ms[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb28-4" title="4">ms &lt;-<span class="st"> </span>ms[,<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb28-5" title="5">ms</a></code></pre></div>
<pre><code>##          ultra.blue       blue      green        red        NIR      SWIR1
## built     0.1770095 0.16882171 0.16839923 0.18151631 0.23660067 0.23342241
## cropland  0.1122196 0.08998683 0.08391113 0.05331576 0.46224299 0.15512451
## fallow    0.1325273 0.11680835 0.10406427 0.11311789 0.17682463 0.23101104
## open      0.1392278 0.13822205 0.15368719 0.20788541 0.34339042 0.35489589
## water     0.1340949 0.11714744 0.09997358 0.07941412 0.04923834 0.03382958
##               SWIR2
## built    0.19172661
## cropland 0.07002481
## fallow   0.19389564
## open     0.21224384
## water    0.02742395</code></pre>
<p>Now we plot the mean spectra of these features.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="co"># Create a vector of color for the land cover classes for use in plotting</span></a>
<a class="sourceLine" id="cb30-2" title="2">mycolor &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;yellow&#39;</span>, <span class="st">&#39;burlywood&#39;</span>, <span class="st">&#39;cyan&#39;</span>, <span class="st">&#39;blue&#39;</span>)</a>
<a class="sourceLine" id="cb30-3" title="3"><span class="co">#transform ms from a data.frame to a matrix</span></a>
<a class="sourceLine" id="cb30-4" title="4">ms &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(ms)</a>
<a class="sourceLine" id="cb30-5" title="5"><span class="co"># First create an empty plot</span></a>
<a class="sourceLine" id="cb30-6" title="6"><span class="kw">plot</span>(<span class="dv">0</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>), <span class="dt">type=</span><span class="st">&#39;n&#39;</span>, <span class="dt">xlab=</span><span class="st">&quot;Bands&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Reflectance&quot;</span>)</a>
<a class="sourceLine" id="cb30-7" title="7"><span class="co"># add the different classes</span></a>
<a class="sourceLine" id="cb30-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ms)){</a>
<a class="sourceLine" id="cb30-9" title="9">  <span class="kw">lines</span>(ms[i,], <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> mycolor[i])</a>
<a class="sourceLine" id="cb30-10" title="10">}</a>
<a class="sourceLine" id="cb30-11" title="11"><span class="co"># Title</span></a>
<a class="sourceLine" id="cb30-12" title="12"><span class="kw">title</span>(<span class="dt">main=</span><span class="st">&quot;Spectral Profile from Landsat&quot;</span>, <span class="dt">font.main =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb30-13" title="13"><span class="co"># Legend</span></a>
<a class="sourceLine" id="cb30-14" title="14"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="kw">rownames</span>(ms),</a>
<a class="sourceLine" id="cb30-15" title="15">       <span class="dt">cex=</span><span class="fl">0.8</span>, <span class="dt">col=</span>mycolor, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">lwd =</span><span class="dv">3</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>The spectral profile shows differences in the reflectance of different eatures of the earth’s surface. Water shows relatively low reflection in all wavelengths and built surfaces have relatively high reflectance in the longer wavelength.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="computation-of-indicators.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
